<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>蝬??賢極??瘥撌亦??亥?蝟餌絞</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="./style.css?v=5">
</head>

<body>
  <!-- ??? -->
  <div class="bg-animation">
    <div class="gradient-orb orb-1"></div>
    <div class="gradient-orb orb-2"></div>
    <div class="gradient-orb orb-3"></div>
  </div>

  <!-- ?餃璅⊥?獢?-->
  <div id="loginModal" class="modal" style="display: none;">
    <div class="modal-content" style="max-width: 450px;">
      <div class="modal-header">
        <h2 class="modal-title">
          <span class="modal-icon">??</span>
          ?餃蝟餌絞
        </h2>
        <button type="button" class="modal-close" onclick="hideLoginInterface()">??/button>
      </div>

      <div class="modal-body">
        <form id="loginForm">
          <div class="form-group">
            <label class="form-label">
              <span class="label-icon">?</span>
              <span>撣唾??縑蝞?/span>
            </label>
            <input type="text" id="loginIdentifier" class="form-input" required placeholder="隢撓?亙董???餃?靽∠拳"
              autocomplete="username">
          </div>

          <div class="form-group">
            <label class="form-label">
              <span class="label-icon">??</span>
              <span>撖Ⅳ</span>
            </label>
            <div class="password-input-wrapper">
              <input type="password" id="loginPassword" class="form-input password-input" required
                placeholder="?身撖Ⅳ嚗?9340505" autocomplete="current-password">
              <button type="button" class="password-toggle-btn" onclick="togglePasswordVisibility()" title="憿舐內/?梯?撖Ⅳ">
                <span id="passwordToggleIcon">??儭?/span>
              </button>
            </div>
          </div>

          <div class="form-actions">
            <button type="button" class="btn btn-secondary" onclick="hideLoginInterface()">
              <span class="btn-icon">??/span>
              <span>??</span>
            </button>
            <button type="submit" class="btn btn-primary">
              <span class="btn-icon">??</span>
              <span>?餃</span>
            </button>
          </div>
        </form>

        <div style="text-align: center; margin-top: var(--spacing);">
          <a href="#" onclick="showForgotPasswordModal(); return false;"
            style="color: var(--primary); text-decoration: none; font-size: 0.9rem; cursor: pointer;">
            ?? 敹?撖Ⅳ嚗?
          </a>
        </div>

        <div
          style="margin-top: var(--spacing-lg); padding-top: var(--spacing-lg); border-top: 1px solid var(--gray-300);">
          <p style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 0.5rem;">
            <strong>? ?內</strong>
          </p>
          <p style="font-size: 0.85rem; color: var(--text-muted);">
            ?臭蝙?具‵銵其犖鞈??葉?董??靽∠拳?餃
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- ?梯????餃摰孵嚗??摰寞改? -->
  <div id="loginContainer" style="display: none;"></div>

  <!-- 銝颱??Ｗ捆??-->
  <div id="mainContainer" class="container" style="display: none;">

    <!-- ?? -->
    <header class="header">
      <div class="header-content">
        <div class="header-left">
          <div class="header-icon">??儭?/div>
          <div>
            <h1 class="header-title">蝬??賢極??瘥撌亦??亥?蝟餌絞</h1>
            <p class="header-subtitle">Construction Daily Log Management System</p>
          </div>
        </div>

        <div class="header-right">
          <!-- 閮芸恥璅∪??餃?? -->
          <div id="guestLoginBtn" style="display: none;">
            <button type="button" class="btn btn-primary" onclick="showLoginInterface()">
              <span class="btn-icon">??</span>
              <span>?餃</span>
            </button>
          </div>

          <!-- 雿輻??閮?-->
          <div id="userInfoPanel" class="user-info-display" style="display: none;">
            <div class="user-info-content">
              <div class="user-info-icon">?</div>
              <div class="user-info-text">
                <div class="user-info-name" id="currentUserName">雿輻??蝔?/div>
                <div class="user-info-role" id="currentUserRole">閫</div>
              </div>
            </div>
            <button id="helpBtn" type="button" class="btn btn-secondary" style="display: none;"
              onclick="showRoleGuideModal()" title="?亦?雿輻隤芣?">
              <span class="btn-icon">??/span>
              <span>雿輻隤芣?</span>
            </button>
            <button id="changePasswordBtn" type="button" class="btn btn-secondary" style="display: none;"
              onclick="showChangePasswordModal()">
              <span class="btn-icon">??</span>
              <span>霈撖Ⅳ</span>
            </button>
            <button id="logoutBtn" type="button" class="btn btn-secondary" style="display: none;">
              <span class="btn-icon">?</span>
              <span>?餃</span>
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- ?惜撠汗 -->
    <div class="tabs">
      <button class="tab active" data-tab="summaryReport">
        <span class="tab-icon">??</span>
        <span class="tab-text">瘥蝮質”</span>
      </button>
      <button class="tab tab-dashboard" data-tab="dashboard" style="display: none;">
        <span class="tab-icon">??</span>
        <span class="tab-text">?銵冽</span>
      </button>
      <button class="tab" data-tab="logEntry">
        <span class="tab-icon">??</span>
        <span class="tab-text">?亥?憛怠</span>
      </button>
      <button class="tab tab-logStatus" data-tab="logStatus">
        <span class="tab-icon">??</span>
        <span class="tab-text">憛怠?瘜?/span>
      </button>
      <button class="tab" data-tab="projectSetup">
        <span class="tab-icon">??</span>
        <span class="tab-text">撌亦?閮剖?</span>
      </button>
      <button class="tab tab-inspectorManagement" data-tab="inspectorManagement">
        <span class="tab-icon">?</span>
        <span class="tab-text">瑼ａ??∠恣??/span>
      </button>
      <button class="tab tab-userManagement" data-tab="userManagement" style="display: none;">
        <span class="tab-icon">??</span>
        <span class="tab-text">雿輻?恣??/span>
      </button>
    </div>

    <!-- ============================================ -->
    <!-- ?惜1嚗隤‵??-->
    <!-- ============================================ -->
    <div id="logEntry" class="tab-pane">

      <!-- ?芸‵撖急????寧憭?＊蝷綽? -->
      <div id="unfilledCardsContainer" style="display: none; margin-bottom: var(--spacing-lg);">
        <!-- ???????∠? -->
      </div>

      <!-- ??內 -->
      <div id="holidayAlert" class="alert-holiday" style="display: none;">
        <div class="holiday-alert-content">
          <div class="holiday-icon">??儭?/div>
          <div class="holiday-info">
            <strong id="holidayDateInfo">?鞈?</strong>
            <p id="holidayRemark" class="holiday-remark"></p>

            <div style="margin-top: 0.5rem; display: flex; gap: 1rem; font-weight: 600; color: var(--warning-dark);">
              <label style="display: flex; align-items: center; gap: 0.25rem; cursor: pointer;">
                <input type="checkbox" id="checkSat"> ??
              </label>
              <label style="display: flex; align-items: center; gap: 0.25rem; cursor: pointer;">
                <input type="checkbox" id="checkSun"> ??
              </label>
              <label style="display: flex; align-items: center; gap: 0.25rem; cursor: pointer;">
                <input type="checkbox" id="checkHoliday"> 靘?
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- ============================================ -->
      <!-- ?惜嚗?銵冽 -->
      <!-- ============================================ -->
      <div id="dashboard" class="tab-pane">
        <div
          style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
          <div class="glass-card" style="text-align: center; padding: 1.5rem;">
            <div style="font-size: 0.9rem; color: #666;">蝮賢極蝔</div>
            <div id="dash-total-projects" style="font-size: 2.5rem; font-weight: bold; color: #333;">-</div>
          </div>
          <div class="glass-card" style="text-align: center; padding: 1.5rem;">
            <div style="font-size: 0.9rem; color: #666;">撌脣‵??/div>
            <div id="dash-filled-count" style="font-size: 2.5rem; font-weight: bold; color: var(--success);">-</div>
          </div>
          <div class="glass-card" style="text-align: center; padding: 1.5rem;">
            <div style="font-size: 0.9rem; color: #666;">?銝撌?/div>
            <div id="dash-holiday-nowork" style="font-size: 2.5rem; font-weight: bold; color: var(--info);">-</div>
          </div>
          <div class="glass-card" style="text-align: center; padding: 1.5rem;">
            <div style="font-size: 0.9rem; color: #666;">憛怠??/div>
            <div id="dash-completion-rate" style="font-size: 2.5rem; font-weight: bold; color: var(--warning);">-</div>
          </div>
        </div>

        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 1.5rem;">
          <div class="glass-card" style="padding: 1.5rem;">
            <canvas id="chart-daily-progress"></canvas>
          </div>
          <div class="glass-card" style="padding: 1.5rem;">
            <canvas id="chart-dept-performance"></canvas>
          </div>
          <div class="glass-card" style="padding: 1.5rem; grid-column: 1 / -1;">
            <canvas id="chart-disaster-stats" style="max-height: 300px;"></canvas>
          </div>
        </div>
      </div>

      <!-- 憛怠銵典 -->
      <div class="glass-card">
        <div class="card-header">
          <div class="card-header-content">
            <div class="card-icon">??</div>
            <div>
              <h2 class="card-title">瘥?賢極?亥?憛怠</h2>
              <p class="card-desc">隢‵撖急??仿?摰撌亙摰?/p>
            </div>
          </div>
          <button type="button" class="btn btn-secondary" onclick="copyLastWorkItems()" style="margin-left: auto;">
            <span class="btn-icon">??</span>
            <span>銴ˊ銝活憛怠神</span>
          </button>
          <!-- [?啣?] ?寞活?閮剖??? -->
          <button type="button" class="btn btn-warning" onclick="showBatchHolidayModal()" style="margin-left: 0.5rem;">
            <span class="btn-icon">??</span>
            <span>?寞活?閮剖?</span>
          </button>
        </div>

        <form id="dailyLogForm">

          <!-- ?箸鞈? -->
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">
                <span class="label-icon">??</span>
                <span>憛怠?交? <span class="required">*</span></span>
              </label>
              <input type="date" id="logDatePicker" class="form-input" required>
            </div>

            <div class="form-group">
              <label class="form-label">
                <span class="label-icon">??儭?/span>
                <span>撌亦??迂 <span class="required">*</span></span>
              </label>
              <select id="logProjectSelect" class="form-select" required>
                <option value="">隢?極蝔?/option>
              </select>
            </div>
          </div>

          <!-- ??賢極?賊? -->
          <div id="holidayWorkGroup" class="form-group" style="display: none;">
            <label class="form-label">
              <span class="label-icon">??儭?/span>
              <span>??賢極?賊?</span>
            </label>

            <div class="checkbox-item-holiday">
              <input type="checkbox" id="isHolidayWork" name="holidayOption">
              <span>????賢極嚗撣豢撌伐?</span>
            </div>

            <div class="checkbox-item-holiday-no-work">
              <input type="checkbox" id="isHolidayNoWork" name="holidayOption">
              <span>??儭??銝撌伐??迫?賢極嚗?/span>
            </div>
          </div>

          <!-- 瑼ａ??⊿??-->
          <div id="inspectorGroup" class="form-group">
            <div
              style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--spacing-sm);">
              <label class="form-label" style="margin-bottom: 0;">
                <span class="label-icon">?</span>
                <span>瑼ａ???<span class="required">*</span></span>
              </label>
              <button type="button" id="changeInspectorBtn" class="btn btn-secondary btn-mini" style="display: none;">
                <span>?? 靽格瑼ａ???/span>
              </button>
            </div>
            <div id="inspectorDisplay"
              style="display: none; padding: var(--spacing); background: var(--gray-50); border: 2px solid var(--success); border-radius: var(--radius); margin-bottom: var(--spacing-sm);">
              <div id="inspectorDisplayText" style="color: var(--text-primary); font-weight: 600;"></div>
            </div>
            <div id="inspectorCheckboxes" class="checkbox-grid" style="display: none;">
              <!-- ???? -->
            </div>
          </div>

          <!-- ?賢極鈭箸 -->
          <div id="workersCountGroup" class="form-group">
            <label class="form-label">
              <span class="label-icon">?????/span>
              <span>?賢極鈭箸 <span class="required">*</span></span>
            </label>
            <input type="number" id="logWorkersCount" class="form-input" min="0" required placeholder="隢撓?交撌乩犖??>
          </div>

          <!-- 靽格迤7嚗極??撠?嚗?箝憓極?? -->
          <div id="workItemsGroup" class="form-group">
            <label class="form-label">
              <span class="label-icon">??儭?/span>
              <span>撌乩???摰喲?撠?<span class="required">*</span></span>
            </label>

            <div id="workItemsContainer">
              <!-- ????撌仿? -->
            </div>

            <button type="button" id="addWorkItemBtn" class="btn btn-secondary" style="margin-top: 1rem;">
              <span class="btn-icon">??/span>
              <span>?啣?撌仿?</span>
            </button>
          </div>

          <!-- ?漱?? -->
          <button type="submit" class="btn btn-primary btn-lg">
            <span class="btn-icon">?</span>
            <span>?漱?亥?</span>
          </button>
        </form>
      </div>
    </div>

    <!-- ============================================ -->
    <!-- ?惜2嚗??仿?摰極蝔隤蜇銵?-->
    <!-- ============================================ -->
    <div id="summaryReport" class="tab-pane active">

      <!-- 閮芸恥璅∪??∠?嚗?餃?＊蝷綽? -->
      <div id="guestSummaryCards" style="display: none; margin-bottom: 2rem;">
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
          <div
            style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); border-radius: 16px; padding: 2rem; color: white; box-shadow: 0 8px 24px rgba(59, 130, 246, 0.3); position: relative;">
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.5rem;">
              <div style="display: flex; align-items: center; gap: 1rem;">
                <span style="font-size: 2.5rem;">??</span>
                <span id="guestDateLabel" style="font-size: 1.1rem; font-weight: 600; opacity: 0.9;">?亥??交?</span>
              </div>
              <div style="display: flex; gap: 0.5rem;">
                <button type="button" id="guestBtnToday" class="guest-mode-btn active"
                  onclick="toggleGuestDate('today')">隞</button>
                <button type="button" id="guestBtnTomorrow" class="guest-mode-btn"
                  onclick="toggleGuestDate('tomorrow')">?</button>
              </div>
            </div>
            <div id="guestDateDisplay" style="font-size: 2rem; font-weight: 700; margin-top: 0.75rem;">
              --
            </div>
          </div>

          <div
            style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); border-radius: 16px; padding: 2rem; color: white; box-shadow: 0 8px 24px rgba(16, 185, 129, 0.3);">
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
              <span style="font-size: 2.5rem;">??儭?/span>
              <span id="guestProjectLabel" style="font-size: 1.1rem; font-weight: 600; opacity: 0.9;">??賢極撌亦?</span>
            </div>
            <div style="display: flex; align-items: baseline; gap: 0.5rem; margin-top: 0.75rem;">
              <span id="guestProjectCount" style="font-size: 2.5rem; font-weight: 700;">0</span>
              <span style="font-size: 1.2rem; opacity: 0.9;">??/span>
            </div>
          </div>
        </div>
      </div>

      <!-- ?批? -->
      <div class="summary-controls">
        <div class="control-group">
          <label class="form-label">
            <span class="label-icon">??</span>
            <span>?豢??交?</span>
          </label>
          <input type="date" id="summaryDatePicker" class="form-input">
        </div>

        <div class="control-group">
          <label class="form-label">
            <span class="label-icon">?</span>
            <span>?券?蝭拚</span>
          </label>
          <select id="summaryDeptFilter" class="form-select">
            <option value="all">?券?券?</option>
          </select>
        </div>

        <!-- [?啣?] 瑼ａ??∠祟??-->
        <div class="control-group">
          <label class="form-label">
            <span class="label-icon">?</span>
            <span>瑼ａ??∠祟??/span>
          </label>
          <select id="summaryInspectorFilter" class="form-select">
            <option value="all">?券瑼ａ???/option>
          </select>
        </div>

        <div class="control-group">
          <label class="form-label">
            <span class="label-icon">??</span>
            <span>撌亦????/span>
          </label>
          <div class="filter-toggle">
            <label class="filter-option">
              <input type="radio" name="summaryStatusFilter" value="all">
              <span>?券撌亦?</span>
            </label>
            <label class="filter-option">
              <input type="radio" name="summaryStatusFilter" value="active" checked>
              <span>?賢極銝?/span>
            </label>
          </div>
        </div>

        <div class="control-group">
          <button id="refreshSummary" class="btn btn-primary" style="margin-top: 1.75rem;">
            <span class="btn-icon">??</span>
            <span>??渡?</span>
          </button>
        </div>
      </div>

      <!-- 璅∪??? -->
      <div class="glass-card">
        <div class="card-header">
          <div class="card-header-content">
            <div class="card-icon">??</div>
            <div>
              <h2 class="card-title">瘥??撌亦??亥?蝮質”</h2>
            </div>
          </div>
          <div id="modeToggle" class="mode-toggle">
            <button class="mode-btn active" data-mode="list">
              <span>?? ?”璅∪?</span>
            </button>
            <button id="calendarModeBtn" class="mode-btn" data-mode="calendar">
              <span>?? ?交?璅∪?</span>
            </button>
          </div>
        </div>

        <!-- ?”瑼Ｚ? -->
        <div id="summaryListView">
          <div class="summary-table-container">
            <table class="summary-table">
              <thead id="summaryTableHead">
                <tr>
                  <th>摨?</th>
                  <th>撌亦??迂</th>
                  <th>?踵??/th>
                  <th>?券?</th>
                  <th>瑼ａ???/th>
                  <th>撌亙鞎痊鈭?/th>
                  <th>?瑕?鈭箏</th>
                  <th>撌乩??啣?</th>
                  <th>?賢極鈭箸</th>
                  <th>銝餉?撌乩??</th>
                  <th>銝餉??賢拿憿?</th>
                  <th>??</th>
                </tr>
              </thead>
              <tbody id="summaryTableBody">
                <tr>
                  <td colspan="12" class="text-muted">隢????亥???/td>
                </tr>
              </tbody>
            </table>
          </div>

          <div id="summaryMobileView" class="mobile-view-container" style="display: none;">
          </div>


        </div>





        <!-- ?交?瑼Ｚ? -->
        <div id="summaryCalendarView" style="display: none;">
          <div class="calendar-header">
            <button class="btn btn-secondary" onclick="changeMonth(-1)">
              <span>? 銝?</span>
            </button>
            <h3 id="calendarTitle">2025撟???/h3>
            <button class="btn btn-secondary" onclick="changeMonth(1)">
              <span>銝? ??/span>
            </button>
          </div>
          <div id="calendarGrid" class="calendar-grid">
            <!-- ???? -->
          </div>
        </div>
      </div>

      <!-- TBM-KY ?? -->
      <div id="tbmkyCard" class="glass-card">
        <div class="card-header">
          <div class="card-header-content">
            <div class="card-icon">??</div>
            <div>
              <h2 class="card-title">TBM-KY ?辣??</h2>
              <p class="card-desc">靘??亥??批捆?芸??? TBM-KY ?辣</p>
            </div>
          </div>
        </div>
        <button id="generateTBMKYBtn" class="btn btn-success btn-lg">
          <span class="btn-icon">??</span>
          <span>?? TBM-KY ?辣</span>
        </button>
      </div>
    </div>

    <!-- ============================================ -->
    <!-- ?惜3嚗隤‵?梁?瘜蜇閬?-->
    <!-- ============================================ -->
    <div id="logStatus" class="tab-pane">

      <div class="glass-card">
        <div class="card-header">
          <div class="card-header-content">
            <div class="card-icon">??</div>
            <div>
              <h2 class="card-title">?亥?憛怠?瘜蜇閬?/h2>
              <p class="card-desc">?嚗?span id="statusTomorrowDate"></span>嚗‵?梢脣漲</p>
            </div>
          </div>
          <button id="refreshLogStatus" class="btn btn-secondary">
            <span class="btn-icon">??</span>
            <span>??渡?</span>
          </button>
        </div>

        <!-- 蝯梯??∠? -->
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-value" id="statTotalProjects">0</div>
            <div class="stat-label">?賢極銝剖極蝔?/div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="statFilledTomorrow">0</div>
            <div class="stat-label">撌脣‵撖?/div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="statCompletionRate">0%</div>
            <div class="stat-label">摰???/div>
          </div>
        </div>

        <!-- ?券?閰單? -->
        <div id="deptCardsContainer">
          <!-- ???? -->
        </div>
      </div>
    </div>

    <!-- ============================================ -->
    <!-- ?惜4嚗極蝔身摰?-->
    <!-- ============================================ -->
    <div id="projectSetup" class="tab-pane">

      <!-- 蝭拚?批 -->
      <div class="project-filter-controls">
        <div class="filter-row">
          <div class="filter-group">
            <label class="form-label">
              <span class="label-icon">?</span>
              <span>?券?蝭拚</span>
            </label>
            <select id="projectDeptFilter" class="form-select">
              <option value="all">?券?券?</option>
            </select>
          </div>

          <div class="filter-group">
            <label class="form-label">
              <span class="label-icon">??</span>
              <span>撌亦????/span>
            </label>
            <div class="filter-toggle">
              <label class="filter-option">
                <input type="radio" name="projectStatusFilter" value="all" checked>
                <span>?券撌亦?</span>
              </label>
              <label class="filter-option">
                <input type="radio" name="projectStatusFilter" value="active">
                <span>?賢極銝?/span>
              </label>
            </div>
          </div>

          <div class="filter-group">
            <button id="refreshProjectList" class="btn btn-primary" style="margin-top: 1.75rem;">
              <span class="btn-icon">??</span>
              <span>??渡?</span>
            </button>
          </div>
        </div>
      </div>

      <!-- 撌亦??∠? -->
      <div class="glass-card">
        <div class="card-header">
          <div class="card-header-content">
            <div class="card-icon">??</div>
            <div>
              <h2 class="card-title">撌亦??箸鞈?蝞∠?</h2>
              <p class="card-desc">暺??∠??舐楊頛臬極蝔???/p>
            </div>
          </div>
        </div>

        <div id="projectCardsContainer" class="project-cards-grid">
          <!-- ???? -->
        </div>
      </div>
    </div>

    <!-- ============================================ -->
    <!-- ?惜5嚗炎撽??憭???恣??-->
    <!-- ============================================ -->
    <div id="inspectorManagement" class="tab-pane">

      <!-- 蝭拚?批 -->
      <div class="inspector-filter-controls">
        <div class="filter-row">
          <div class="filter-group">
            <label class="form-label">
              <span class="label-icon">?</span>
              <span>?券?蝭拚</span>
            </label>
            <select id="inspectorDeptFilter" class="form-select">
              <option value="all">?券?券?</option>
            </select>
          </div>

          <div class="filter-group">
            <label class="form-label">
              <span class="label-icon">??</span>
              <span>??祟??/span>
            </label>
            <div class="filter-toggle">
              <label class="filter-option">
                <input type="radio" name="inspectorStatusFilter" value="all" checked>
                <span>?券???/span>
              </label>
              <label class="filter-option">
                <input type="radio" name="inspectorStatusFilter" value="active">
                <span>?銝?/span>
              </label>
            </div>
          </div>

          <div class="filter-group">
            <button id="refreshInspectorList" class="btn btn-primary" style="margin-top: 1.75rem;">
              <span class="btn-icon">??</span>
              <span>??渡?</span>
            </button>
          </div>
        </div>
      </div>

      <!-- 瑼ａ??∪??-->
      <div class="glass-card">
        <div class="card-header">
          <div class="card-header-content">
            <div class="card-icon">?</div>
            <div>
              <h2 class="card-title">瑼ａ??∪?憪?????恣??/h2>
              <p class="card-desc">蝞∠???炎撽??憭?犖??/p>
            </div>
          </div>
          <button id="addInspectorBtn" class="btn btn-success">
            <span class="btn-icon">??/span>
            <span>?啣?瑼ａ???/span>
          </button>
        </div>

        <div id="inspectorCardsContainer" class="inspector-cards-grid">
          <!-- ???? -->
        </div>
      </div>
    </div>

  </div>

  <!-- ============================================ -->
  <!-- 敶?嚗楊頛舐蜇銵冽隤?-->
  <!-- ============================================ -->
  <div id="editSummaryLogModal" class="modal">
    <div class="modal-content modal-lg">
      <div class="modal-header">
        <h3>蝺刻摩?亥?</h3>
        <button class="modal-close" onclick="closeEditSummaryLogModal()">?</button>
      </div>
      <div class="modal-body">
        <p class="modal-subtitle" id="editSummaryLogProjectName"></p>

        <input type="hidden" id="editSummaryLogDate">
        <input type="hidden" id="editSummaryLogProjectSeqNo">
        <input type="hidden" id="editSummaryIsHolidayNoWork">

        <!-- ?璅? -->
        <div id="editHolidayNoWorkBadge" class="alert alert-info" style="display: none;">
          <strong>??儭?甇斤?銝撌亥???/strong>
          <p>?亥?靽格隢?文??憛怠神</p>
        </div>

        <div id="editHolidayWorkBadge" class="alert alert-warning" style="display: none;">
          <strong>??儭???賢極</strong>
        </div>

        <!-- ??賢極?? -->
        <div id="editHolidayWorkToggle" class="form-group" style="display: none;">
          <label class="checkbox-item-holiday">
            <input type="checkbox" id="editIsHolidayWork">
            <span>????賢極</span>
          </label>
        </div>

        <!-- 瑼ａ???-->
        <div id="editSummaryInspectorGroup" class="form-group">
          <label class="form-label">
            <span class="label-icon">?</span>
            <span>瑼ａ??∴??臬??賂?</span>
          </label>
          <div id="editInspectorCheckboxes" class="checkbox-grid">
            <!-- ???? -->
          </div>
        </div>

        <!-- ?賢極鈭箸 -->
        <div id="editSummaryWorkersGroup" class="form-group">
          <label class="form-label">
            <span class="label-icon">?????/span>
            <span>?賢極鈭箸</span>
          </label>
          <input type="number" id="editSummaryWorkersCount" class="form-input" min="0">
        </div>

        <!-- 撌仿??” -->
        <div id="editSummaryWorkItemsGroup" class="form-group">
          <label class="form-label">
            <span class="label-icon">??儭?/span>
            <span>撌乩??</span>
          </label>
          <div id="editWorkItemsList">
            <!-- ???? -->
          </div>
          <button type="button" class="btn btn-secondary" onclick="copyPreviousDayData()" style="margin-top: 1rem;">
            <span class="btn-icon">??</span>
            <span>銴ˊ??憭抵???/span>
          </button>
        </div>

        <!-- 靽格?? -->
        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">??</span>
            <span>靽格?? <span class="required">*</span></span>
          </label>
          <textarea id="editSummaryReason" class="form-textarea" rows="2" required placeholder="隢陛餈唬耨?孵???></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" onclick="closeEditSummaryLogModal()">??</button>
        <button type="button" class="btn btn-primary" onclick="confirmEditSummaryLog()">
          <span class="btn-icon">??/span>
          <span>蝣箄?靽格</span>
        </button>
      </div>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- 敶?嚗‵銵其犖?芸‵撖急???-->
  <!-- ============================================ -->
  <div id="fillerReminderModal" class="modal">
    <div class="modal-content" style="max-width: 800px; max-height: 85vh; overflow-y: auto;">
      <div class="modal-header">
        <h3>?? 憛怠神??</h3>
        <button class="modal-close" onclick="closeFillerReminderModal()">?</button>
      </div>
      <div class="modal-body" id="fillerReminderContent" style="max-height: calc(85vh - 140px); overflow-y: auto;">
        <!-- ???? -->
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" onclick="closeFillerReminderModal()">???</button>
      </div>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- [?啣?] 敶?嚗甈∪??亥身摰?-->
  <!-- ============================================ -->
  <div id="batchHolidayModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>
          <span class="modal-icon">??</span>
          ?寞活?閮剖?
        </h3>
        <button class="modal-close" onclick="closeBatchHolidayModal()">?</button>
      </div>
      <div class="modal-body">
        <div class="alert alert-info">
          <p>甇文??賢?寞活撠?摰????望?身?箝??乩??賢極??/p>
        </div>

        <div class="form-group">
          <label class="form-label">?交?蝭?</label>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
            <div>
              <label style="font-size: 0.9rem; color: var(--text-muted);">???交?</label>
              <input type="date" id="batchStartDate" class="form-input">
            </div>
            <div>
              <label style="font-size: 0.9rem; color: var(--text-muted);">蝯??交?</label>
              <input type="date" id="batchEndDate" class="form-input">
            </div>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">閮剖?撠情</label>
          <div class="checkbox-group">
            <label class="checkbox-item">
              <input type="checkbox" id="batchCheckSat" checked>
              <span>????/span>
            </label>
            <label class="checkbox-item">
              <input type="checkbox" id="batchCheckSun" checked>
              <span>????/span>
            </label>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">?豢?撌亦?</label>
          <div style="margin-bottom: 0.5rem;">
            <label class="checkbox-item">
              <input type="checkbox" id="batchSelectAllProjects" onchange="toggleBatchAllProjects(this)">
              <span>?券??撌乩葉撌亦?</span>
            </label>
          </div>
          <div id="batchProjectList" class="checkbox-grid"
            style="max-height: 200px; overflow-y: auto; border: 1px solid var(--gray-300); padding: 0.5rem; border-radius: var(--radius);">
            <!-- ????撌亦??” -->
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" onclick="closeBatchHolidayModal()">??</button>
        <button type="button" class="btn btn-primary" onclick="submitBatchHoliday()">
          <span class="btn-icon">??</span>
          <span>???寞活閮剖?</span>
        </button>
      </div>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- 敶?嚗??游?蝣?-->
  <!-- ============================================ -->
  <!-- 雿輻隤芣?璅⊥?獢?-->
  <div id="roleGuideModal" class="modal">
    <div class="modal-content" style="max-width: 700px;">
      <div class="modal-header">
        <h3>
          <span class="modal-icon">??</span>
          雿輻隤芣?
        </h3>
        <button class="modal-close" onclick="closeRoleGuideModal()">?</button>
      </div>
      <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">

        <!-- 憛怨”鈭箄鞎?-->
        <div id="fillerGuide" style="display: none;">
          <div
            style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; border-radius: var(--radius); margin-bottom: 1.5rem;">
            <h4 style="margin: 0 0 0.5rem 0; font-size: 1.3rem; display: flex; align-items: center; gap: 0.5rem;">
              <span style="font-size: 1.5rem;">?</span>
              憛怨”鈭箄鞎?
            </h4>
            <p style="margin: 0; opacity: 0.95; font-size: 0.95rem;">?函?銝餉?隞餃??臬‵撖急??亙極蝔隤蒂蝞∠?撌亦?閮剖?</p>
          </div>

          <div
            style="background: var(--gray-50); padding: 1.5rem; border-radius: var(--radius); margin-bottom: 1rem; border-left: 4px solid var(--primary);">
            <h5 style="margin: 0 0 1rem 0; color: var(--primary); display: flex; align-items: center; gap: 0.5rem;">
              <span>??</span>
              <span>1. 憛怠神瘥?亥??啣神</span>
            </h5>
            <ul style="margin: 0; padding-left: 1.5rem; line-height: 1.8;">
              <li>瘥予憛怠神????賢極?批捆</li>
              <li>閮??賢極鈭箸?炎撽?極雿???/li>
              <li>?豢?撠??摰喲???/li>
              <li>??賢極??孵璅酉</li>
            </ul>
          </div>

          <div
            style="background: var(--gray-50); padding: 1.5rem; border-radius: var(--radius); border-left: 4px solid var(--success);">
            <h5 style="margin: 0 0 1rem 0; color: var(--success); display: flex; align-items: center; gap: 0.5rem;">
              <span>??</span>
              <span>2. 蝞∠?撌亦?閮剖?</span>
            </h5>
            <ul style="margin: 0; padding-left: 1.5rem; line-height: 1.8;">
              <li><strong>撌亙鞎痊鈭綽?</strong>憛怠神憪??閰?/li>
              <li><strong>?瑕?鈭箏嚗?/strong>憛怠神憪??閰?/li>
              <li><strong>撌亦????</strong>?湔?箝撌乩葉?歇摰極??</li>
              <li><strong>?身瑼ａ??∴?</strong>閮剖?撣貊?炎撽</li>
            </ul>
          </div>

          <div
            style="background: #fff3cd; padding: 1rem; border-radius: var(--radius); margin-top: 1.5rem; border: 2px solid #ffc107;">
            <p style="margin: 0; color: #856404; display: flex; align-items: flex-start; gap: 0.5rem;">
              <span style="font-size: 1.2rem;">?</span>
              <span><strong>?內嚗?/strong>憒??啣?撌亦??耨?孵隞身摰?隢蝜怨蝯∪?????/span>
            </p>
          </div>
        </div>

        <!-- ?舐窗?∟鞎?-->
        <div id="contactGuide" style="display: none;">
          <div
            style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 1.5rem; border-radius: var(--radius); margin-bottom: 1.5rem;">
            <h4 style="margin: 0 0 0.5rem 0; font-size: 1.3rem; display: flex; align-items: center; gap: 0.5rem;">
              <span style="font-size: 1.5rem;">?</span>
              ?舐窗?∟鞎?
            </h4>
            <p style="margin: 0; opacity: 0.95; font-size: 0.95rem;">?刻?鞎祉頂蝯梁恣??雿輻???身摰?/p>
          </div>

          <div
            style="background: var(--gray-50); padding: 1.5rem; border-radius: var(--radius); margin-bottom: 1rem; border-left: 4px solid #e91e63;">
            <h5 style="margin: 0 0 1rem 0; color: #e91e63; display: flex; align-items: center; gap: 0.5rem;">
              <span>?</span>
              <span>1. 雿輻?恣??/span>
            </h5>
            <ul style="margin: 0; padding-left: 1.5rem; line-height: 1.8;">
              <li><strong>撱箇?憛怨”鈭綽?</strong>?啣?憛怨”鈭箏董??/li>
              <li><strong>閮剖?撣唾?撖Ⅳ嚗?/strong>?箏‵銵其犖閮剖??餃鞈?</li>
              <li><strong>閮剖?靽∠拳嚗?/strong>憛怠神憛怨”鈭箇? Email ?啣?</li>
              <li><strong>??撌亦?嚗?/strong>閮剖?憛怨”鈭箄?憛怠?極蝔???/li>
            </ul>
          </div>

          <div
            style="background: var(--gray-50); padding: 1.5rem; border-radius: var(--radius); margin-bottom: 1rem; border-left: 4px solid #ff9800;">
            <h5 style="margin: 0 0 1rem 0; color: #ff9800; display: flex; align-items: center; gap: 0.5rem;">
              <span>??儭?/span>
              <span>2. 蝞∠?撌亦?閮剖?</span>
            </h5>
            <ul style="margin: 0; padding-left: 1.5rem; line-height: 1.8;">
              <li><strong>?湔撌亦????</strong>璅?撌亦??箝撌乩葉?歇摰極??</li>
              <li><strong>閮剖??身瑼ａ??∴?</strong>?箏極蝔?摰虜?冽炎撽</li>
            </ul>
          </div>

          <div
            style="background: var(--gray-50); padding: 1.5rem; border-radius: var(--radius); border-left: 4px solid #4caf50;">
            <h5 style="margin: 0 0 1rem 0; color: #4caf50; display: flex; align-items: center; gap: 0.5rem;">
              <span>??</span>
              <span>3. 瑼ａ??∠恣??/span>
            </h5>
            <ul style="margin: 0; padding-left: 1.5rem; line-height: 1.8;">
              <li><strong>撱箇?瑼ａ??∴?</strong>?啣?瑼ａ??∟???/li>
              <li><strong>閮剖?憪???璆哨?</strong>憛怠神瑼ａ??∠?撠平??</li>
            </ul>
          </div>

          <div
            style="background: #d1ecf1; padding: 1rem; border-radius: var(--radius); margin-top: 1.5rem; border: 2px solid #17a2b8;">
            <p style="margin: 0; color: #0c5460; display: flex; align-items: flex-start; gap: 0.5rem;">
              <span style="font-size: 1.2rem;">?對?</span>
              <span><strong>瘜冽?嚗?/strong>?舐窗?⊥???擃???隢牲??雿蝙?刻?撌亦?鞈???/span>
            </p>
          </div>
        </div>

        <!-- ?隤芣?嚗????脤憿舐內嚗?-->
        <div style="margin-top: 2rem; padding-top: 1.5rem; border-top: 2px dashed var(--gray-300);">
          <h5 style="margin: 0 0 1rem 0; color: var(--text-primary); display: flex; align-items: center; gap: 0.5rem;">
            <span>??</span>
            <span>撣唾?摰</span>
          </h5>
          <ul style="margin: 0; padding-left: 1.5rem; line-height: 1.8; color: var(--text-secondary);">
            <li>擐活?餃敺?蝡霈?身撖Ⅳ</li>
            <li>摰??湔撖Ⅳ隞亦Ⅱ靽董????/li>
            <li>銝???鈭箏?鈭急?董??蝣?/li>
          </ul>
        </div>

        <div style="margin-top: 1.5rem;">
          <h5 style="margin: 0 0 1rem 0; color: var(--text-primary); display: flex; align-items: center; gap: 0.5rem;">
            <span>?</span>
            <span>?銵??/span>
          </h5>
          <p style="margin: 0; padding-left: 1.5rem; line-height: 1.8; color: var(--text-secondary);">
            憒?隞颱?????閬??抬?隢蝜怎頂蝯梁恣???
          </p>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" onclick="closeRoleGuideModal()">
          <span class="btn-icon">??/span>
          <span>???</span>
        </button>
      </div>
    </div>
  </div>

  <!-- 霈撖Ⅳ璅⊥?獢?-->
  <div id="changePasswordModal" class="modal">
    <div class="modal-content" style="max-width: 450px;">
      <div class="modal-header">
        <h3>霈撖Ⅳ</h3>
        <button class="modal-close" onclick="closeChangePasswordModal()">?</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">??</span>
            <span>??蝣?<span class="required">*</span></span>
          </label>
          <input type="password" id="oldPassword" class="form-input" required>
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">??</span>
            <span>?啣?蝣?<span class="required">*</span></span>
          </label>
          <input type="password" id="newPassword" class="form-input" required>
          <p class="form-hint">撖Ⅳ?瑕漲?喳? 6 雿?/p>
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">??/span>
            <span>蝣箄??啣?蝣?<span class="required">*</span></span>
          </label>
          <input type="password" id="confirmPassword" class="form-input" required>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" onclick="closeChangePasswordModal()">??</button>
        <button type="button" class="btn btn-primary" onclick="submitChangePassword()">
          <span class="btn-icon">?</span>
          <span>蝣箄?霈</span>
        </button>
      </div>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- 敶?嚗楊頛臬極蝔???-->
  <!-- ============================================ -->
  <div id="editProjectModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>蝺刻摩撌亦?鞈?</h3>
        <button class="modal-close" onclick="closeEditProjectModal()">?</button>
      </div>
      <div class="modal-body">
        <p class="modal-subtitle" id="editProjectName"></p>

        <input type="hidden" id="editProjectSeqNo">

        <!-- ?拇?雿? -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1rem;">
          <div class="form-group" style="margin-bottom: 0;">
            <label class="form-label">
              <span class="label-icon">?</span>
              <span>撌亙鞎痊鈭?<span class="required">*</span></span>
            </label>
            <input type="text" id="editResp" class="form-input" required>
          </div>

          <div class="form-group" style="margin-bottom: 0;">
            <label class="form-label">
              <span class="label-icon">??</span>
              <span>鞎痊鈭粹閰?/span>
            </label>
            <input type="tel" id="editRespPhone" class="form-input" placeholder="?詨‵">
          </div>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1.5rem; margin-bottom: 1rem;">
          <div class="form-group" style="margin-bottom: 0;">
            <label class="form-label">
              <span class="label-icon">?死</span>
              <span>?瑕?鈭箏 <span class="required">*</span></span>
            </label>
            <input type="text" id="editSafetyOfficer" class="form-input" required>
          </div>

          <div class="form-group" style="margin-bottom: 0;">
            <label class="form-label">
              <span class="label-icon">??</span>
              <span>霅</span>
            </label>
            <select id="editSafetyLicense" class="form-select">
              <option value="">隢??/option>
              <option value="?脣?">?脣?</option>
              <option value="?脰?">?脰?</option>
              <option value="銋">銋</option>
              <option value="?脫平">?脫平</option>
              <option value="?璆?>?璆?/option>
              <option value="銋平">銋平</option>
            </select>
          </div>

          <div class="form-group" style="margin-bottom: 0;">
            <label class="form-label">
              <span class="label-icon">??</span>
              <span>?瑕??餉店</span>
            </label>
            <input type="tel" id="editSafetyPhone" class="form-input" placeholder="?詨‵">
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">??</span>
            <span>撌亦????<span class="required">*</span></span>
          </label>
          <select id="editProjectStatus" class="form-select" required>
            <option value="?賢極銝?>?賢極銝?/option>
            <option value="蝡?極">蝡?極</option>
            <option value="?怠??賢極">?怠??賢極</option>
          </select>
        </div>

        <!-- ???閮鳴??撌乩葉??憛恬? -->
        <div id="editStatusRemarkGroup" class="form-group" style="display: none;">
          <label class="form-label">
            <span class="label-icon">??</span>
            <span>???閮?<span class="required">*</span></span>
          </label>
          <textarea id="editStatusRemark" class="form-textarea" rows="2" placeholder="隢牧?咯撌交??怠??賢極????></textarea>
          <p class="form-hint">?? 撌亦????咯撌乓???撌乓?嚗??‵撖怠?閮餉牧????/p>
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">?</span>
            <span>?身瑼ａ???/span>
          </label>
          <div id="editDefaultInspectorCheckboxes" class="checkbox-grid">
            <!-- ???? -->
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">??</span>
            <span>靽格?? <span class="required">*</span></span>
          </label>
          <textarea id="editProjectReason" class="form-textarea" rows="2" required placeholder="隢陛餈唬耨?孵???></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" onclick="closeEditProjectModal()">??</button>
        <button type="button" class="btn btn-primary" onclick="confirmEditProject()">
          <span class="btn-icon">??/span>
          <span>蝣箄?靽格</span>
        </button>
      </div>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- 敶?嚗憓炎撽 -->
  <!-- ============================================ -->
  <div id="addInspectorModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>?啣?瑼ａ???/h3>
        <button class="modal-close" onclick="closeAddInspectorModal()">?</button>
      </div>
      <div class="modal-body">
        <div
          style="background-color: var(--primary-light); padding: var(--spacing); border-radius: 8px; margin-bottom: var(--spacing-lg);">
          <p style="margin: 0; font-size: 0.9rem; color: var(--text-muted);">
            <strong>? ?芸?蝺刻?嚗?/strong>
            <span id="addInspectorIdPreview" style="font-size: 1.1rem; margin-left: 0.5rem;">隢??豢??券?</span>
          </p>
        </div>

        <!-- 靽格迤10嚗?璆剝??箝??具?璇啜瘞??-->
        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">?</span>
            <span>?券? <span class="required">*</span></span>
          </label>
          <select id="addInspectorDept" class="form-select" required onchange="updateInspectorIdPreview()">
            <option value="">隢??</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">?</span>
            <span>憪? <span class="required">*</span></span>
          </label>
          <input type="text" id="addInspectorName" class="form-input" required>
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">??</span>
            <span>?瑞迂 <span class="required">*</span></span>
          </label>
          <input type="text" id="addInspectorTitle" class="form-input" required placeholder="靘?嚗極蝔葦??撣怎?">
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">?</span>
            <span>撠平 <span class="required">*</span></span>
          </label>
          <select id="addInspectorProfession" class="form-select" required>
            <option value="">隢??璆?/option>
            <option value="?">?</option>
            <option value="璈１">璈１</option>
            <option value="?餅除">?餅除</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">??</span>
            <span>?餉店</span>
          </label>
          <input type="tel" id="addInspectorPhone" class="form-input" placeholder="?詨‵">
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">??</span>
            <span>?啣??? <span class="required">*</span></span>
          </label>
          <textarea id="addInspectorReason" class="form-textarea" rows="2" required placeholder="隢陛餈唳憓???></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" onclick="closeAddInspectorModal()">??</button>
        <button type="button" class="btn btn-success" onclick="confirmAddInspector()">
          <span class="btn-icon">??/span>
          <span>蝣箄??啣?</span>
        </button>
      </div>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- 敶?嚗楊頛舀炎撽 -->
  <!-- ============================================ -->
  <div id="editInspectorModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>蝺刻摩瑼ａ??∟???/h3>
        <button class="modal-close" onclick="closeEditInspectorModal()">?</button>
      </div>
      <div class="modal-body">
        <p class="modal-subtitle">蝺刻?嚗?strong id="editInspectorIdDisplay"></strong>嚗??臭耨?對?</p>

        <input type="hidden" id="editInspectorId">

        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">?</span>
            <span>?券? <span class="required">*</span></span>
          </label>
          <select id="editInspectorDept" class="form-select" required>
            <option value="">隢??</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">?</span>
            <span>憪? <span class="required">*</span></span>
          </label>
          <input type="text" id="editInspectorName" class="form-input" required>
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">??</span>
            <span>?瑞迂 <span class="required">*</span></span>
          </label>
          <input type="text" id="editInspectorTitle" class="form-input" required>
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">?</span>
            <span>撠平 <span class="required">*</span></span>
          </label>
          <select id="editInspectorProfession" class="form-select" required>
            <option value="">隢??璆?/option>
            <option value="?">?</option>
            <option value="璈１">璈１</option>
            <option value="?餅除">?餅除</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">??</span>
            <span>?餉店</span>
          </label>
          <input type="tel" id="editInspectorPhone" class="form-input" placeholder="?詨‵">
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">??</span>
            <span>靽格?? <span class="required">*</span></span>
          </label>
          <textarea id="editInspectorReason" class="form-textarea" rows="2" required placeholder="隢陛餈唬耨?孵???></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" onclick="closeEditInspectorModal()">??</button>
        <button type="button" class="btn btn-primary" onclick="confirmEditInspector()">
          <span class="btn-icon">??/span>
          <span>蝣箄?靽格</span>
        </button>
      </div>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- 敶?嚗BM-KY ?? -->
  <!-- ============================================ -->
  <div id="tbmkyModal" class="modal">
    <div class="modal-content modal-sm">
      <div class="modal-header">
        <h3>?? TBM-KY ?辣</h3>
        <button class="modal-close" onclick="closeTBMKYModal()">?</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">??儭?/span>
            <span>?豢?撌亦?</span>
          </label>
          <select id="tbmkyProjectSelect" class="form-select">
            <option value="">隢?極蝔?/option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">??</span>
            <span>?豢??交?</span>
          </label>
          <input type="date" id="tbmkyDatePicker" class="form-input">
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">??</span>
            <span>??璅∪?</span>
          </label>
          <label class="checkbox-item-large">
            <input type="radio" name="tbmkyMode" value="merged" checked>
            <span>?蔥璅∪?嚗???獢?</span>
          </label>
          <label class="checkbox-item-large">
            <input type="radio" name="tbmkyMode" value="separate">
            <span>??璅∪?嚗??極????獢?</span>
          </label>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" onclick="closeTBMKYModal()">??</button>
        <button type="button" class="btn btn-success" onclick="confirmGenerateTBMKY()">
          <span class="btn-icon">??</span>
          <span>????</span>
        </button>
      </div>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- 敶?嚗BM-KY ??蝯? -->
  <!-- ============================================ -->
  <div id="tbmkyResultModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>TBM-KY ??摰?</h3>
        <button class="modal-close" onclick="closeTBMKYResultModal()">?</button>
      </div>
      <div class="modal-body">
        <div class="alert alert-success">
          <strong>??<span id="tbmkyResultMessage">????嚗?/span></strong>
        </div>

        <div id="tbmkyFilesList" class="tbmky-files-list">
          <!-- ???? -->
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" onclick="closeTBMKYResultModal()">
          <span class="btn-icon">??/span>
          <span>蝣箏?</span>
        </button>
      </div>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- 敶?嚗?底??-->
  <!-- ============================================ -->
  <div id="calendarDetailModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>?交?閰單?嚗?span id="detailDateTitle"></span></h3>
        <button class="modal-close" onclick="closeCalendarDetailModal()">?</button>
      </div>
      <div class="modal-body">
        <div id="calendarDetailContent">
          <!-- ???? -->
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" onclick="closeCalendarDetailModal()">??</button>
      </div>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- 敶?嚗絞銝蝣箄?閬? -->
  <!-- ============================================ -->
  <!-- 敹?撖Ⅳ Modal -->
  <div id="forgotPasswordModal" class="modal">
    <div class="modal-content" style="max-width: 500px;">
      <div class="modal-header">
        <h3>?? 敹?撖Ⅳ</h3>
        <button class="modal-close" onclick="closeForgotPasswordModal()">?</button>
      </div>
      <div class="modal-body">
        <p style="color: #6b7280; margin-bottom: 1.5rem;">
          隢撓?交?董??閮餃?靽∠拳嚗頂蝯勗??潮??蝣潸?函?靽∠拳??
        </p>
        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">?</span>
            <span>撣唾??縑蝞?/span>
          </label>
          <input type="text" id="forgotPasswordInput" class="form-input" placeholder="隢撓?亙董???餃?靽∠拳" required>
        </div>
        <div style="background: #fef3c7; padding: 1rem; border-radius: 8px; margin-top: 1rem;">
          <p style="color: #92400e; font-size: 0.875rem; margin: 0;">
            ? ?冽?撖Ⅳ撠??刻酉??憛怠神?縑蝞梧?隢?亙?蝡霈撖Ⅳ??
          </p>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" onclick="closeForgotPasswordModal()">??</button>
        <button type="button" class="btn btn-primary" onclick="submitForgotPassword()">
          <span class="btn-icon">?</span>
          <span>?潮??蝣?/span>
        </button>
      </div>
    </div>
  </div>

  <div id="confirmModal" class="modal">
    <div class="modal-content modal-confirm">
      <div class="modal-header">
        <h3>?? 隢Ⅱ隤?雿?/h3>
        <button class="modal-close" onclick="closeConfirmModal()">?</button>
      </div>
      <div class="modal-body">
        <div id="confirmMessage" class="confirm-message">
          <!-- ???批捆 -->
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" onclick="closeConfirmModal()">??</button>
        <button type="button" id="confirmBtn" class="btn btn-primary">
          <span class="btn-icon">??/span>
          <span>蝣箄??瑁?</span>
        </button>
      </div>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- ?惜6嚗蝙?刻恣??-->
  <!-- ============================================ -->
  <div id="userManagement" class="tab-pane">
    <div class="page-header">
      <h2 id="userManagementTitle">雿輻?恣??/h2>
      <div style="display: flex; align-items: center; gap: 1rem;">
        <p id="userManagementHint" style="display: none; margin: 0; color: #6b7280; font-size: 0.875rem;">
          ? ?內嚗炬閮剖??踵?‵銵其犖鞈???臬‵撖怎?撌亦??嚗??暸撠??恣?極蝔???
        </p>
        <button class="btn btn-primary" onclick="openAddUserModal()">
          <span>???啣?雿輻??/span>
        </button>
      </div>
    </div>

    <!-- 蝭拚? -->
    <div
      style="background: white; padding: 1.5rem; border-radius: 12px; margin-bottom: 1.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
      <div style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
        <!-- 閫蝭拚 -->
        <div style="flex: 1; min-width: 200px;">
          <label
            style="display: block; font-weight: 600; color: #374151; margin-bottom: 0.5rem; font-size: 0.875rem;">?
            閫蝭拚</label>
          <select id="userRoleFilter" class="form-select" onchange="applyUserFilters()" style="width: 100%;">
            <option value="all">?券閫</option>
            <option value="頞?蝞∠???>頞?蝞∠???/option>
            <option value="?舐窗??>?舐窗??/option>
            <option value="憛怨”鈭?>憛怨”鈭?/option>
          </select>
        </div>

        <!-- ?券?蝭拚 -->
        <div style="flex: 1; min-width: 200px;">
          <label
            style="display: block; font-weight: 600; color: #374151; margin-bottom: 0.5rem; font-size: 0.875rem;">?
            ?券?蝭拚</label>
          <select id="userDeptFilter" class="form-select" onchange="applyUserFilters()" style="width: 100%;">
            <option value="all">?券?券?</option>
            <!-- ???? -->
          </select>
        </div>

        <!-- ??獢?-->
        <div style="flex: 2; min-width: 250px;">
          <label
            style="display: block; font-weight: 600; color: #374151; margin-bottom: 0.5rem; font-size: 0.875rem;">??
            ??</label>
          <input type="text" id="userSearchInput" class="form-input" placeholder="??憪??董?mail..."
            oninput="applyUserFilters()" style="width: 100%;">
        </div>

        <!-- 皜?? -->
        <div style="align-self: flex-end;">
          <button class="btn" onclick="clearUserFilters()"
            style="background: #6b7280; color: white; padding: 0.625rem 1.25rem;">
            ?? 皜蝭拚
          </button>
        </div>
      </div>

      <!-- 蝯梯?鞈? -->
      <div id="userFilterStats"
        style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #e5e7eb; color: #6b7280; font-size: 0.875rem;">
        <span>?? ??<strong id="userTotalCount" style="color: #3b82f6; font-size: 1.1rem;">0</strong> 雿蝙?刻?/span>
      </div>
    </div>

    <!-- 雿輻??銵?-->
    <div id="userListContainer" class="card-container">
      <!-- ???? -->
    </div>
  </div>

  <!-- ============================================ -->
  <!-- 敶?嚗憓?蝺刻摩雿輻??-->
  <!-- ============================================ -->
  <div id="addUserModal" class="modal">
    <div class="modal-content" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
      <div class="modal-header"
        style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; padding: 1.5rem 2rem;">
        <h3 id="addUserModalTitle" style="margin: 0; font-size: 1.5rem; font-weight: 700;">?啣?雿輻??/h3>
        <button class="btn-icon" onclick="closeAddUserModal()" style="background: rgba(255,255,255,0.2); color: white;">
          <span class="icon">??/span>
        </button>
      </div>

      <div class="modal-body" style="padding: 2rem;">
        <input type="hidden" id="editUserRowIndex">

        <!-- ?拇?雿? -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem;">
          <!-- 撌行? -->
          <div>
            <div class="form-group" style="margin-bottom: 1.5rem;">
              <label
                style="display: flex; align-items: center; gap: 0.5rem; font-weight: 600; color: #374151; margin-bottom: 0.5rem;">
                <span style="font-size: 1.25rem;">?</span>
                <span>?券?</span>
              </label>
              <select id="userDept" class="form-select"
                style="width: 100%; padding: 0.75rem; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 0.95rem;">
                <option value="">隢??</option>
              </select>
            </div>

            <div class="form-group" style="margin-bottom: 1.5rem;">
              <label
                style="display: flex; align-items: center; gap: 0.5rem; font-weight: 600; color: #374151; margin-bottom: 0.5rem;">
                <span style="font-size: 1.25rem;">?</span>
                <span>憪?</span>
                <span style="color: #ef4444; font-size: 1.1rem;">*</span>
              </label>
              <input type="text" id="userName" placeholder="靘?嚗?撠?" required class="form-input"
                style="width: 100%; padding: 0.75rem; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 0.95rem;">
            </div>

            <div class="form-group" style="margin-bottom: 1.5rem;">
              <label
                style="display: flex; align-items: center; gap: 0.5rem; font-weight: 600; color: #374151; margin-bottom: 0.5rem;">
                <span style="font-size: 1.25rem;">??</span>
                <span>撣唾?</span>
                <span style="color: #ef4444; font-size: 1.1rem;">*</span>
              </label>
              <input type="text" id="userAccount" placeholder="靘?嚗ang001" required class="form-input"
                style="width: 100%; padding: 0.75rem; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 0.95rem; font-family: monospace;">
            </div>
          </div>

          <!-- ?單? -->
          <div>
            <div class="form-group" style="margin-bottom: 1.5rem;">
              <label
                style="display: flex; align-items: center; gap: 0.5rem; font-weight: 600; color: #374151; margin-bottom: 0.5rem;">
                <span style="font-size: 1.25rem;">?</span>
                <span>Email</span>
                <span style="color: #ef4444; font-size: 1.1rem;">*</span>
              </label>
              <input type="email" id="userEmail" placeholder="靘?嚗ang@example.com" required class="form-input"
                style="width: 100%; padding: 0.75rem; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 0.95rem;">
            </div>

            <div class="form-group" style="margin-bottom: 1.5rem;">
              <label
                style="display: flex; align-items: center; gap: 0.5rem; font-weight: 600; color: #374151; margin-bottom: 0.5rem;">
                <span style="font-size: 1.25rem;">??</span>
                <span>頨怠?</span>
                <span style="color: #ef4444; font-size: 1.1rem;">*</span>
              </label>
              <select id="userRole" onchange="handleRoleChange()" required class="form-select"
                style="width: 100%; padding: 0.75rem; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 0.95rem;">
                <option value="憛怨”鈭?>憛怨”鈭?/option>
                <option value="?舐窗??>?舐窗??/option>
                <option value="頞?蝞∠???>頞?蝞∠???/option>
              </select>
            </div>

            <div class="form-group" style="margin-bottom: 1.5rem;">
              <label
                style="display: flex; align-items: center; gap: 0.5rem; font-weight: 600; color: #374151; margin-bottom: 0.5rem;">
                <span style="font-size: 1.25rem;">??</span>
                <span>撖Ⅳ</span>
                <span id="passwordRequired" style="color: #ef4444; font-size: 1.1rem;">*</span>
              </label>
              <input type="password" id="userPassword" placeholder="隢撓?亙?蝣? class="form-input"
                style="width: 100%; padding: 0.75rem; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 0.95rem;">
              <small id="passwordHint"
                style="display: none; color: #6b7280; font-size: 0.85rem; margin-top: 0.25rem; display: block;">蝺刻摩???征銵函內銝耨?孵?蝣?/small>
            </div>
          </div>
        </div>

        <!-- 銝餌恣 Email嚗撖穿? -->
        <div class="form-group" style="margin-bottom: 1.5rem;">
          <label
            style="display: flex; align-items: center; gap: 0.5rem; font-weight: 600; color: #374151; margin-bottom: 0.5rem;">
            <span style="font-size: 1.25rem;">??</span>
            <span>銝餌恣 Email</span>
          </label>
          <input type="email" id="userSupervisorEmail" placeholder="靘?嚗upervisor@example.com" class="form-input"
            style="width: 100%; padding: 0.75rem; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 0.95rem;">
        </div>

        <!-- 蝞∠?撌亦?嚗撖穿??箇?撘? -->
        <div class="form-group" id="managedProjectsGroup" style="display: none;">
          <label
            style="display: flex; align-items: center; gap: 0.5rem; font-weight: 600; color: #374151; margin-bottom: 0.75rem;">
            <span style="font-size: 1.25rem;">??儭?/span>
            <span>蝞∠?撌亦?摨?</span>
            <span style="color: #ef4444; font-size: 1.1rem;">*</span>
          </label>
          <div
            style="background: #f9fafb; padding: 1.25rem; border-radius: 12px; border: 2px solid #e5e7eb; max-height: 400px; overflow-y: auto;">
            <div id="managedProjectsCheckboxes" style="display: flex; flex-direction: column; gap: 0.75rem;">
              <!-- ?????券??? -->
            </div>
          </div>
          <small
            style="color: #6b7280; font-size: 0.85rem; margin-top: 0.5rem; display: block;">?豢?甇文‵銵其犖?臬‵撖怎?撌亦?嚗??敹恍?賂?</small>
        </div>
      </div>

      <div class="modal-footer"
        style="padding: 1.5rem 2rem; background: #f9fafb; border-top: 2px solid #e5e7eb; display: flex; gap: 1rem; justify-content: flex-end;">
        <button class="btn" onclick="closeAddUserModal()"
          style="padding: 0.75rem 2rem; font-size: 1rem; background: #6b7280; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
          ??
        </button>
        <button class="btn btn-primary" onclick="confirmAddUser()"
          style="padding: 0.75rem 2rem; font-size: 1rem; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);">
          蝣箄?
        </button>
      </div>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- Loading ? -->
  <!-- ============================================ -->
  <div id="loadingOverlay" class="loading">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <div class="loading-text">??銝哨?隢???..</div>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- Toast ?嚗耨甇?嚗-index??嚗?-->
  <!-- ============================================ -->
  <div id="toast" class="toast"></div>

  <script src="./app.js?v=5"></script>
</body>

</html>
